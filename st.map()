import streamlit as st
import pandas as pd
import json

# Load resources data from JSON
def load_resources():
    with open('resources.json', 'r') as f:
        resources = json.load(f)
    return pd.DataFrame(resources)

# Main Streamlit app
def main():
    st.title("Healthcare Resources Finder in Erbil")
    st.write("Find hospitals, clinics, and pharmacies in Erbil available for refugees and residents.")

    # Load data
    df = load_resources()

    # Filter for healthcare-related resources (hospitals, clinics, pharmacies) in Erbil
    healthcare_types = ["Hospital", "Clinic", "Pharmacy"]
    erbil_df = df[(df['location'] == 'Erbil') & (df['type'].isin(healthcare_types))]

    if erbil_df.empty:
        st.write("No healthcare resources found in Erbil.")
    else:
        st.write(f"### Healthcare Resources in Erbil")
        st.write(erbil_df[['name', 'contact', 'services']])

        # Display the map with healthcare resource locations
        st.write("### Healthcare Locations on Map")
        healthcare_resources = erbil_df[['latitude', 'longitude', 'name']]
        st.map(healthcare_resources)

    # Option to display all healthcare resources
    if st.button("Show All Healthcare Resources in Erbil"):
        st.write("### All Healthcare Resources in Erbil")
        st.write(erbil_df[['name', 'type', 'location', 'contact', 'services']])

        # Display the map with all healthcare resources in Erbil
        st.write("### All Healthcare Resource Locations on Map")
        all_healthcare = erbil_df[['latitude', 'longitude', 'name']]
        st.map(all_healthcare)

if __name__ == "__main__":
    main()
